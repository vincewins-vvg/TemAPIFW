apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: paymentorder-ingester-undertow
  namespace: default
spec:
  template:
    spec:
      containers:
        - image: dev.local/temenos/ms-paymentorder-ingester:1.1
          ports:
          - name: http1
            containerPort: 8080
          env:
            - name: DATABASE_KEY
              value: cassandra
            - name: CASSANDRA_HOST
              value: paymentorder-db-service
            - name: CASSANDRA_PORT
              value: "9042"
            - name: CASSANDRA_USER
              value: cassandra
            - name: CASSANDRA_PASS
              value:
            - name: CASSANDRA_KEYSPACE
              value: ms_paymentorder
            - name: CASSANDRA_SSL
              value:
            - name: CASSANDRA_KEYSTORE_FILE_PATH
              value:
            - name: CASSANDRA_KEYSTORE_PASSWORD
              value:
            - name: temn.msf.name
              value: PaymentOrder  
            - name: PDP_CONFIG
              value: classpath:xacml/payments-pdp-config.xml
            - name: temn.msf.pdp.resource.type
              value: API
            - name: temn.msf.pdp.resource.manager
              value: PAYMENT
            - name: tem.msf.disableInbox
              value: "true"
            - name: temn.msf.security.authz.enabled
              value: "false"
            - name: class.inbox.dao
              value: com.temenos.microservice.framework.core.inbox.InboxDaoImpl
            - name: class.outbox.dao
              value: com.temenos.microservice.framework.core.outbox.OutboxDaoImpl
            - name: EXECUTION_ENV
              value: TEST
            - name: temn.msf.ingest.event.ingester
              value: com.temenos.microservice.framework.core.ingester.MicroserviceIngester
            - name: PAYMENT_ORDEREvent
              value: com.temenos.microservice.paymentorder.ingester.PaymentorderIngesterUpdater
            - name: temn.msf.schema.registry.url
              value: "Payment.Order"